CREATE MATERIALIZED VIEW birdnet_results_filtered AS
SELECT r.* FROM birdnet_results r
LEFT JOIN files_audio f ON r.file_id = f.file_id
WHERE
(deployment_id = 541  AND "time" BETWEEN '2023-05-11 00:00:00' AND '2023-06-27 00:00:00' AND species IN ('Sylvia atricapilla','Aegithalos caudatus','Turdus merula','Fringilla coelebs','Certhia brachydactyla','Troglodytes troglodytes','Picus viridis','Phylloscopus collybita','Regulus ignicapilla','Columba palumbus','Ardea cinerea','Erithacus rubecula','Parus major','Poecile palustris','Muscicapa striata','Dendrocoptes medius','Pyrrhula pyrrhula','Alcedo atthis','Dendrocopos major','Oriolus oriolus','Strix aluco','Turdus viscivorus','Apus apus','Mergus merganser','Motacilla cinerea','Turdus philomelos','Asio otus','Carduelis carduelis','Falco tinnunculus','Garrulus glandarius','Buteo buteo','Corvus corone','Cyanistes caeruleus','Cygnus olor','Dryobates minor','Fulica atra','Lophophanes cristatus','Periparus ater','Sitta europaea','Tachybaptus ruficollis')) or
(deployment_id = 679  AND "time" BETWEEN '2023-05-11 00:00:00' AND '2023-06-27 00:00:00' AND species IN ('Sylvia atricapilla','Troglodytes troglodytes','Certhia brachydactyla','Motacilla cinerea','Aegithalos caudatus','Turdus merula','Muscicapa striata','Alcedo atthis','Anas platyrhynchos','Apus apus','Cyanistes caeruleus','Erithacus rubecula','Tachybaptus ruficollis','Turdus viscivorus','Motacilla alba','Dendrocoptes medius','Picus viridis','Alopochen aegyptiaca','Pica pica','Coccothraustes coccothraustes','Poecile palustris','Regulus ignicapilla','Ardea cinerea','Cygnus olor','Milvus milvus','Parus major','Phylloscopus collybita','Sturnus vulgaris','Actitis hypoleucos','Dendrocopos major','Fulica atra','Regulus regulus','Acrocephalus scirpaceus','Buteo buteo','Chloris chloris','Columba palumbus','Dryocopus martius','Gallinula chloropus','Garrulus glandarius','Phoenicurus ochruros','Phylloscopus bonelli','Prunella modularis','Pyrrhula pyrrhula','Turdus philomelos')) or
(deployment_id = 616  AND "time" BETWEEN '2023-05-11 00:00:00' AND '2023-06-27 00:00:00' AND species IN ('Lanius collurio','Aegithalos caudatus','Turdus merula','Parus major','Certhia brachydactyla','Apus apus','Picus viridis','Alcedo atthis','Buteo buteo','Poecile palustris','Strix aluco','Dendrocopos major','Cyanistes caeruleus','Fulica atra','Motacilla cinerea','Serinus serinus','Anas platyrhynchos','Ardea cinerea','Coccothraustes coccothraustes','Cygnus olor','Sylvia atricapilla','Turdus philomelos')) or
(deployment_id = 503  AND "time" BETWEEN '2023-05-11 00:00:00' AND '2023-06-27 00:00:00' AND species IN ('Turdus merula','Aegithalos caudatus','Carduelis carduelis','Sylvia atricapilla','Motacilla cinerea','Chloris chloris','Motacilla alba','Delichon urbicum','Anas platyrhynchos','Alcedo atthis','Apus apus','Phalacrocorax carbo','Phoenicurus ochruros','Picus viridis','Turdus viscivorus','Gallinula chloropus','Parus major','Pica pica','Erithacus rubecula','Mergus merganser','Alopochen aegyptiaca','Apus melba','Ardea cinerea','Buteo buteo','Certhia brachydactyla','Columba palumbus','Cyanistes caeruleus','Pyrrhula pyrrhula','Regulus ignicapilla','Regulus regulus','Sturnus vulgaris')) or
(deployment_id = 6    AND "time" BETWEEN '2021-05-11 00:00:00' AND '2021-06-27 00:00:00' AND species IN ('Turdus merula','Erithacus rubecula','Certhia brachydactyla','Apus apus','Fringilla coelebs','Columba palumbus','Alopochen aegyptiaca','Turdus philomelos','Cuculus canorus','Sylvia atricapilla','Muscicapa striata','Motacilla cinerea','Carduelis carduelis','Picus viridis','Parus major','Poecile palustris','Strix aluco','Phoenicurus ochruros','Turdus viscivorus','Falco tinnunculus','Aegithalos caudatus','Sitta europaea','Coccothraustes coccothraustes','Dendrocopos major','Motacilla alba','Ardea cinerea','Dendrocoptes medius','Passer domesticus','Sturnus vulgaris','Milvus milvus','Asio otus','Serinus serinus','Alcedo atthis','Cyanistes caeruleus','Luscinia megarhynchos','Buteo buteo','Chloris chloris','Dryocopus martius','Ficedula hypoleuca','Phylloscopus sibilatrix','Regulus ignicapilla','Certhia familiaris','Corvus corone','Cygnus olor','Emberiza citrinella','Garrulus glandarius','Mergus merganser','Phoenicurus phoenicurus')) or
(deployment_id = 3    AND "time" BETWEEN '2021-05-11 00:00:00' AND '2021-06-27 00:00:00' AND species IN ('Apus apus','Turdus merula','Phoenicurus ochruros','Carduelis carduelis','Motacilla cinerea','Turdus viscivorus','Passer montanus','Columba palumbus','Passer domesticus','Delichon urbicum','Falco tinnunculus','Milvus milvus','Sturnus vulgaris','Muscicapa striata','Picus viridis','Erithacus rubecula','Parus major','Alcedo atthis','Strix aluco','Coccothraustes coccothraustes','Sylvia atricapilla','Ardea cinerea','Aegithalos caudatus','Certhia brachydactyla','Dendrocopos major','Gallinula chloropus','Turdus philomelos','Anthus pratensis','Chloris chloris','Corvus corone','Fulica atra','Alopochen aegyptiaca','Certhia familiaris','Cuculus canorus','Cyanistes caeruleus','Fringilla coelebs','Luscinia megarhynchos','Regulus ignicapilla','Troglodytes troglodytes')) or
(deployment_id = 4    AND "time" BETWEEN '2021-05-11 00:00:00' AND '2021-06-27 00:00:00' AND species IN ('Apus apus','Motacilla cinerea','Delichon urbicum','Turdus merula','Phoenicurus ochruros','Columba palumbus','Passer domesticus','Certhia brachydactyla','Parus major','Picus viridis','Aegithalos caudatus','Serinus serinus','Strix aluco','Falco tinnunculus','Passer montanus','Ardea cinerea','Dendrocoptes medius','Milvus milvus','Erithacus rubecula','Lophophanes cristatus','Streptopelia decaocto','Troglodytes troglodytes')) or
(deployment_id = 5    AND "time" BETWEEN '2021-05-11 00:00:00' AND '2021-06-27 00:00:00' AND species IN ('Muscicapa striata','Carduelis carduelis','Turdus merula','Apus apus','Sturnus vulgaris','Motacilla cinerea','Certhia brachydactyla','Cyanistes caeruleus','Columba palumbus','Phoenicurus ochruros','Troglodytes troglodytes','Serinus serinus','Aegithalos caudatus','Phylloscopus collybita','Picus viridis','Chloris chloris','Coccothraustes coccothraustes','Sylvia atricapilla','Poecile palustris','Alcedo atthis','Strix aluco','Dendrocopos major','Dryocopus martius','Erithacus rubecula','Hippolais icterina','Cuculus canorus','Delichon urbicum','Fringilla coelebs','Sitta europaea','Turdus philomelos','Parus major','Regulus ignicapilla','Ardea cinerea','Dendrocoptes medius','Buteo buteo','Certhia familiaris','Regulus regulus','Turdus viscivorus','Passer domesticus','Alopochen aegyptiaca','Milvus milvus','Corvus corone','Falco tinnunculus','Sylvia borin','Anas platyrhynchos','Lophophanes cristatus','Mergus merganser','Motacilla alba','Passer montanus')) or
(deployment_id = 7    AND "time" BETWEEN '2021-05-11 00:00:00' AND '2021-06-27 00:00:00' AND species IN ('Sylvia atricapilla','Acrocephalus scirpaceus','Motacilla cinerea','Troglodytes troglodytes','Gallinula chloropus','Turdus merula','Aegithalos caudatus','Carduelis carduelis','Erithacus rubecula','Columba palumbus','Fringilla coelebs','Muscicapa striata','Chloris chloris','Serinus serinus','Apus apus','Coccothraustes coccothraustes','Certhia brachydactyla','Oriolus oriolus','Dendrocoptes medius','Phalacrocorax carbo','Luscinia megarhynchos','Picus viridis','Hippolais icterina','Cyanistes caeruleus','Parus major','Alcedo atthis','Corvus frugilegus','Mergus merganser','Sitta europaea','Sylvia borin','Certhia familiaris','Poecile palustris','Strix aluco','Ardea cinerea','Buteo buteo','Turdus philomelos','Falco tinnunculus','Corvus corone','Streptopelia decaocto','Anas platyrhynchos','Dryocopus martius','Lophophanes cristatus','Phylloscopus collybita','Regulus regulus','Corvus corax','Cygnus olor','Dendrocopos major','Dryobates minor','Falco peregrinus','Fulica atra','Garrulus glandarius','Milvus migrans','Milvus milvus','Periparus ater','Pica pica','Regulus ignicapilla','Turdus viscivorus')) or
(deployment_id = 1243 AND "time" BETWEEN '2023-05-11 00:00:00' AND '2023-06-27 00:00:00' AND species IN ('Phoenicurus ochruros','Motacilla alba','Carduelis carduelis','Apus apus','Passer domesticus','Parus major','Milvus milvus','Phalacrocorax carbo','Chloris chloris','Corvus frugilegus','Passer montanus','Accipiter nisus','Aegithalos caudatus','Dendrocopos major','Erithacus rubecula','Falco tinnunculus','Lophophanes cristatus','Milvus migrans','Motacilla cinerea','Pica pica','Regulus ignicapilla','Serinus serinus','Turdus philomelos','Turdus viscivorus')) or
(deployment_id = 1261 AND "time" BETWEEN '2023-05-11 00:00:00' AND '2023-06-27 00:00:00' AND species IN ('Carduelis carduelis','Phoenicurus ochruros','Passer domesticus','Apus apus','Turdus merula','Cyanistes caeruleus','Motacilla alba','Motacilla cinerea','Sitta europaea','Chloris chloris','Coccothraustes coccothraustes','Dendrocopos major','Lophophanes cristatus','Corvus corone','Erithacus rubecula','Parus major','Certhia brachydactyla','Pyrrhula pyrrhula','Spinus spinus','Turdus philomelos','Turdus viscivorus','Ardea cinerea','Buteo buteo','Certhia familiaris','Corvus corax','Delichon urbicum','Hirundo rustica','Troglodytes troglodytes'))
;
GRANT SELECT ON birdnet_results_filtered TO mitwelten_internal;
